<mat-tab-group *ngIf="showTableView" mat-align-tabs="center" (selectedTabChange)="switchTab($event.index)" [selectedIndex]="selectedTab">
    <mat-tab label="All">
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
            <!-- Checkbox Column -->
            <ng-container matColumnDef="select">
                <th mat-header-cell *matHeaderCellDef>
                    <mat-checkbox (change)="$event ? masterToggle() : null"
                        [checked]="selection.hasValue() && isAllSelected()"
                        [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
                    </mat-checkbox>
                </th>
                <td mat-cell *matCellDef="let row">
                    <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null"
                        [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                    </mat-checkbox>
                </td>
            </ng-container>

            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> Bin ID </th>
                <td mat-cell *matCellDef="let element"> {{element.id}} </td>
            </ng-container>

            <ng-container matColumnDef="municipality">
                <th mat-header-cell *matHeaderCellDef> Municipality </th>
                <td mat-cell *matCellDef="let element"> {{element.municipality}} </td>
            </ng-container>

            <ng-container matColumnDef="area">
                <th mat-header-cell *matHeaderCellDef> Area </th>
                <td mat-cell *matCellDef="let element"> {{element.area}} </td>
            </ng-container>

            <ng-container matColumnDef="latitude">
                <th mat-header-cell *matHeaderCellDef> Latitude </th>
                <td mat-cell *matCellDef="let element"> {{element.latitude}} </td>
            </ng-container>

            <ng-container matColumnDef="longitude">
                <th mat-header-cell *matHeaderCellDef> Longitude </th>
                <td mat-cell *matCellDef="let element"> {{element.longitude}} </td>
            </ng-container>

            <ng-container matColumnDef="level">
                <th mat-header-cell *matHeaderCellDef> Level </th>
                <td mat-cell *matCellDef="let element"> {{element.level}} </td>
            </ng-container>

            <ng-container matColumnDef="staffName">
                <th mat-header-cell *matHeaderCellDef> Garbage Collector </th>
                <td mat-cell *matCellDef="let element"><a title="Click to see staff details" class="staff-name" (click)="showStaffDetails(element.staffId)">{{element.staffName}}</a></td>
            </ng-container>

            <ng-container matColumnDef="staffMobileNo">
                <th mat-header-cell *matHeaderCellDef> Contact </th>
                <td mat-cell *matCellDef="let element"> {{element.staffMobileNo}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;">
            </tr>
        </table>

        <div class="no-data" *ngIf="dataSource.filteredData.length == 0">No bins</div>
    </mat-tab>

    <mat-tab label="Almost Full">
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
            <!-- Checkbox Column -->
            <ng-container matColumnDef="select">
                <th mat-header-cell *matHeaderCellDef>
                    <mat-checkbox (change)="$event ? masterToggle() : null"
                        [checked]="selection.hasValue() && isAllSelected()"
                        [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
                    </mat-checkbox>
                </th>
                <td mat-cell *matCellDef="let row">
                    <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null"
                        [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                    </mat-checkbox>
                </td>
            </ng-container>

            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> Bin ID </th>
                <td mat-cell *matCellDef="let element"> {{element.id}} </td>
            </ng-container>

            <ng-container matColumnDef="municipality">
                <th mat-header-cell *matHeaderCellDef> Municipality </th>
                <td mat-cell *matCellDef="let element"> {{element.municipality}} </td>
            </ng-container>

            <ng-container matColumnDef="area">
                <th mat-header-cell *matHeaderCellDef> Area </th>
                <td mat-cell *matCellDef="let element"> {{element.area}} </td>
            </ng-container>

            <ng-container matColumnDef="latitude">
                <th mat-header-cell *matHeaderCellDef> Latitude </th>
                <td mat-cell *matCellDef="let element"> {{element.latitude}} </td>
            </ng-container>

            <ng-container matColumnDef="longitude">
                <th mat-header-cell *matHeaderCellDef> Longitude </th>
                <td mat-cell *matCellDef="let element"> {{element.longitude}} </td>
            </ng-container>

            <ng-container matColumnDef="level">
                <th mat-header-cell *matHeaderCellDef> Level </th>
                <td mat-cell *matCellDef="let element"> {{element.level}} </td>
            </ng-container>

            <ng-container matColumnDef="staffName">
                <th mat-header-cell *matHeaderCellDef> Garbage Collector </th>
                <td mat-cell *matCellDef="let element"><a title="Click to see staff details" class="staff-name" (click)="showStaffDetails(element.staffId)">{{element.staffName}}</a></td>
            </ng-container>

            <ng-container matColumnDef="staffMobileNo">
                <th mat-header-cell *matHeaderCellDef> Contact </th>
                <td mat-cell *matCellDef="let element"> {{element.staffMobileNo}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;">
            </tr>
        </table>

        <div class="no-data" *ngIf="dataSource.filteredData.length == 0">No bins</div>
    </mat-tab>

    <mat-tab label="Medium Level">
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
            <!-- Checkbox Column -->
            <ng-container matColumnDef="select">
                <th mat-header-cell *matHeaderCellDef>
                    <mat-checkbox (change)="$event ? masterToggle() : null"
                        [checked]="selection.hasValue() && isAllSelected()"
                        [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
                    </mat-checkbox>
                </th>
                <td mat-cell *matCellDef="let row">
                    <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null"
                        [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                    </mat-checkbox>
                </td>
            </ng-container>

            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> Bin ID </th>
                <td mat-cell *matCellDef="let element"> {{element.id}} </td>
            </ng-container>

            <ng-container matColumnDef="municipality">
                <th mat-header-cell *matHeaderCellDef> Municipality </th>
                <td mat-cell *matCellDef="let element"> {{element.municipality}} </td>
            </ng-container>

            <ng-container matColumnDef="area">
                <th mat-header-cell *matHeaderCellDef> Area </th>
                <td mat-cell *matCellDef="let element"> {{element.area}} </td>
            </ng-container>

            <ng-container matColumnDef="latitude">
                <th mat-header-cell *matHeaderCellDef> Latitude </th>
                <td mat-cell *matCellDef="let element"> {{element.latitude}} </td>
            </ng-container>

            <ng-container matColumnDef="longitude">
                <th mat-header-cell *matHeaderCellDef> Longitude </th>
                <td mat-cell *matCellDef="let element"> {{element.longitude}} </td>
            </ng-container>

            <ng-container matColumnDef="level">
                <th mat-header-cell *matHeaderCellDef> Level </th>
                <td mat-cell *matCellDef="let element"> {{element.level}} </td>
            </ng-container>

            <ng-container matColumnDef="staffName">
                <th mat-header-cell *matHeaderCellDef> Garbage Collector </th>
                <td mat-cell *matCellDef="let element"><a title="Click to see staff details" class="staff-name" (click)="showStaffDetails(element.staffId)">{{element.staffName}}</a></td>
            </ng-container>

            <ng-container matColumnDef="staffMobileNo">
                <th mat-header-cell *matHeaderCellDef> Contact </th>
                <td mat-cell *matCellDef="let element"> {{element.staffMobileNo}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;">
            </tr>
        </table>

        <div class="no-data" *ngIf="dataSource.filteredData.length == 0">No bins</div>
    </mat-tab>

    <mat-tab label="Low Level">
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
            <!-- Checkbox Column -->
            <ng-container matColumnDef="select">
                <th mat-header-cell *matHeaderCellDef>
                    <mat-checkbox (change)="$event ? masterToggle() : null"
                        [checked]="selection.hasValue() && isAllSelected()"
                        [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
                    </mat-checkbox>
                </th>
                <td mat-cell *matCellDef="let row">
                    <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null"
                        [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                    </mat-checkbox>
                </td>
            </ng-container>

            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> Bin ID </th>
                <td mat-cell *matCellDef="let element"> {{element.id}} </td>
            </ng-container>

            <ng-container matColumnDef="municipality">
                <th mat-header-cell *matHeaderCellDef> Municipality </th>
                <td mat-cell *matCellDef="let element"> {{element.municipality}} </td>
            </ng-container>

            <ng-container matColumnDef="area">
                <th mat-header-cell *matHeaderCellDef> Area </th>
                <td mat-cell *matCellDef="let element"> {{element.area}} </td>
            </ng-container>

            <ng-container matColumnDef="latitude">
                <th mat-header-cell *matHeaderCellDef> Latitude </th>
                <td mat-cell *matCellDef="let element"> {{element.latitude}} </td>
            </ng-container>

            <ng-container matColumnDef="longitude">
                <th mat-header-cell *matHeaderCellDef> Longitude </th>
                <td mat-cell *matCellDef="let element"> {{element.longitude}} </td>
            </ng-container>

            <ng-container matColumnDef="level">
                <th mat-header-cell *matHeaderCellDef> Level </th>
                <td mat-cell *matCellDef="let element"> {{element.level}} </td>
            </ng-container>

            <ng-container matColumnDef="staffName">
                <th mat-header-cell *matHeaderCellDef> Garbage Collector </th>
                <td mat-cell *matCellDef="let element"><a title="Click to see staff details" class="staff-name" (click)="showStaffDetails(element.staffId)">{{element.staffName}}</a></td>
            </ng-container>

            <ng-container matColumnDef="staffMobileNo">
                <th mat-header-cell *matHeaderCellDef> Contact </th>
                <td mat-cell *matCellDef="let element"> {{element.staffMobileNo}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;">
            </tr>
        </table>

        <div class="no-data" *ngIf="dataSource.filteredData.length == 0">No bins</div>
    </mat-tab>
</mat-tab-group>

<div class="btn-options-wrapper" *ngIf="dataSource.filteredData.length > 0">
    <button mat-raised-button color="primary" (click)="showInMap()" *ngIf="showTableView">Show in Map View</button>
    <button mat-raised-button color="primary" (click)="showCollectionHistory()" *ngIf="showTableView">Show Collection History</button>
    <button mat-raised-button color="primary" (click)="markAsCollected()" *ngIf="showTableView && roleId==3">Trash Collected</button>

    <!-- <button mat-raised-button color="primary" (click)="toggleView()" *ngIf="showMapView">Return to Table View</button> -->
    <button mat-icon-button color="primary" aria-label="Back button" title="Return to Table View" (click)="toggleView()" *ngIf="showMapView">
        <mat-icon>keyboard_backspace</mat-icon>
    </button>
    <!-- <button mat-raised-button color="primary" (click)="toggleView()" *ngIf="showMapView && roleId==3">Show Optimal Route</button> -->
</div>

<app-map *ngIf="showMapView" [binData]="selectedData" [zoom]="zoom" [latitude]="centralLatitude"
    [longitude]="centralLongitude"></app-map>